/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var g=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var T=(o,i)=>{for(var t in i)g(o,t,{get:i[t],enumerable:!0})},k=(o,i,t,e)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of w(i))!E.call(o,s)&&s!==t&&g(o,s,{get:()=>i[s],enumerable:!(e=y(i,s))||e.enumerable});return o};var L=o=>k(g({},"__esModule",{value:!0}),o);var M={};T(M,{default:()=>m});module.exports=L(M);var b=require("obsidian");var h={customButtons:[]};function v(){return{icon:"lucide-plus",tooltip:"\u65B0\u6309\u94AE",type:"command",command:"",file:"",url:""}}var f=require("obsidian"),c=class{constructor(i,t,e){this.app=i;this.onSettingsChange=t;this.onReorderButtons=e;this.ribbonMap=new Map;this.styleElements={};this.dragState={isDragging:!1,dragSource:null}}initVaultButtons(i){this.clearAllButtons(),this.initCustomButtons(i),this.initBuiltInButtons()}clearAllButtons(){this.ribbonMap.forEach(i=>{i&&i.parentElement&&i.remove()}),this.ribbonMap.clear()}initCustomButtons(i){i.forEach((t,e)=>{this.createCustomButton(t,e)})}initBuiltInButtons(){[{id:"theme",tooltip:"\u5207\u6362\u6DF1\u8272/\u6D45\u8272\u6A21\u5F0F",icon:"lucide-sun-moon",onClick:()=>this.switchLightDark(),draggable:!1},{id:"vault",tooltip:"\u5207\u6362\u5E93",icon:"vault",onClick:()=>this.showVaultChooser(),draggable:!1},{id:"help",tooltip:"\u5E2E\u52A9",icon:"help",onClick:()=>this.showHelp(),draggable:!1},{id:"settings",tooltip:"\u8BBE\u7F6E",icon:"lucide-settings",onClick:()=>this.showSettings(),draggable:!1}].forEach(t=>{this.createRibbonButton(t.id,t.tooltip,t.icon,t.onClick,t.draggable)})}createCustomButton(i,t){let e=`custom-${t}`,s=()=>{this.handleButtonClick(i)};return this.createRibbonButton(e,i.tooltip,i.icon,s,!0)}handleButtonClick(i){switch(i.type){case"command":i.command&&this.executeCommand(i.command);break;case"file":i.file&&this.openFile(i.file);break;case"url":i.url&&window.open(i.url,"_blank");break}}openFile(i){let t=this.app.vault.getAbstractFileByPath(i);t&&t instanceof f.TFile&&this.app.workspace.getLeaf("tab").openFile(t)}createRibbonButton(i,t,e,s,n=!1){try{let a=this.app.workspace.leftRibbon,l=a.makeRibbonItemButton(e,t,C=>{C.stopPropagation(),s()});return n&&this.makeButtonDraggable(l,i),this.ribbonMap.set(i,l),a.ribbonSettingEl.appendChild(l),l}catch(a){console.warn("Failed to create ribbon button:",a);let l=document.createElement("div");return l.style.display="none",l}}makeButtonDraggable(i,t){i.setAttribute("draggable","true"),i.classList.add("custom-ribbon-button"),i.addEventListener("dragstart",e=>{this.dragState.isDragging=!0,this.dragState.dragSource=t,i.classList.add("dragging"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",t)}),i.addEventListener("dragend",e=>{this.dragState.isDragging=!1,this.dragState.dragSource=null,i.classList.remove("dragging"),document.querySelectorAll(".custom-ribbon-button.drag-over").forEach(s=>{s.classList.remove("drag-over")})}),i.addEventListener("dragover",e=>{this.dragState.isDragging&&this.dragState.dragSource!==t&&(e.preventDefault(),e.dataTransfer.dropEffect="move",i.classList.add("drag-over"))}),i.addEventListener("dragenter",e=>{this.dragState.isDragging&&this.dragState.dragSource!==t&&(e.preventDefault(),i.classList.add("drag-over"))}),i.addEventListener("dragleave",e=>{i.classList.remove("drag-over")}),i.addEventListener("drop",e=>{e.preventDefault(),i.classList.remove("drag-over"),this.dragState.isDragging&&this.dragState.dragSource&&this.dragState.dragSource!==t&&this.handleReorderButtons(this.dragState.dragSource,t)})}handleReorderButtons(i,t){let e=parseInt(i.split("-")[1]),s=parseInt(t.split("-")[1]);e!==s&&this.onReorderButtons(e,s)}executeCommand(i){try{this.app.commands.executeCommandById(i)}catch(t){console.warn("Failed to execute command:",i,t)}}showVaultChooser(){try{this.app.openVaultChooser()}catch(i){console.warn("Failed to open vault chooser:",i)}}showHelp(){try{this.app.openHelp()}catch(i){console.warn("Failed to open help:",i)}}showSettings(){try{this.app.setting.open()}catch(i){console.warn("Failed to open settings:",i)}}switchLightDark(){try{this.app.vault.getConfig("theme")==="obsidian"?(this.app.setTheme("moonstone"),this.app.vault.setConfig("theme","moonstone"),this.app.workspace.trigger("css-change")):(this.app.setTheme("obsidian"),this.app.vault.setConfig("theme","obsidian"),this.app.workspace.trigger("css-change"))}catch(i){console.warn("Failed to switch theme:",i)}}applyStyleSettings(){[{id:"vault-profile",css:`
				body:not(.is-mobile) .workspace-split.mod-left-split .workspace-sidedock-vault-profile {
					display: none;
				}
			`},{id:"vault-switcher",css:`
				body:not(.is-mobile) .workspace-split.mod-left-split .workspace-sidedock-vault-profile .workspace-drawer-vault-switcher {
					display: none;
				}
			`},{id:"vault-actions-help",css:`
				body:not(.is-mobile) .workspace-split.mod-left-split .workspace-sidedock-vault-profile .workspace-drawer-vault-actions .clickable-icon:has(svg.svg-icon.help) {
					display: none;
				}
			`},{id:"vault-actions-settings",css:`
				body:not(.is-mobile) .workspace-split.mod-left-split .workspace-sidedock-vault-profile .workspace-drawer-vault-actions .clickable-icon:has(svg.svg-icon.lucide-settings) {
					display: none;
				}
			`},{id:"vault-actions-theme",css:`
				body:not(.is-mobile) .workspace-split.mod-left-split .workspace-sidedock-vault-profile .workspace-drawer-vault-actions .clickable-icon:has(svg.svg-icon.lucide-sun-moon) {
					display: none;
				}
			`}].forEach(({id:t,css:e})=>{this.updateStyle(t,e)})}updateStyle(i,t){let e=this.styleElements[i];e||(e=document.createElement("style"),e.id=i,document.head.appendChild(e),this.styleElements[i]=e),e.textContent=t}destroy(){this.clearAllButtons();for(let i in this.styleElements)this.styleElements[i].remove();this.styleElements={}}};var r=require("obsidian");var B=require("obsidian"),u=class extends B.FuzzySuggestModal{constructor(t,e){super(t);this.onChoose=e}getItems(){try{return this.app.vault.getFiles()}catch(t){return console.warn("Failed to get files:",t),[]}}getItemText(t){return t.path}onChooseItem(t,e){this.onChoose(t)}};var S=require("obsidian"),p=class extends S.FuzzySuggestModal{constructor(t,e){super(t);this.onChoose=e}getItems(){try{let t=this.app.commands.commands,e=[];for(let s in t){let n=t[s];e.push(n)}return e}catch(t){return console.warn("Failed to get commands:",t),[]}}getItemText(t){return t.name}onChooseItem(t,e){this.onChoose(t)}};var d=class extends r.PluginSettingTab{constructor(t,e){super(t,e);this.plugin=e}display(){let{containerEl:t}=this;t.empty(),this.createHeader(t),this.createDescription(t),this.plugin.settings.customButtons.length===0?this.createEmptyState(t):this.createButtonsList(t),this.createAddButton(t)}createHeader(t){t.createEl("h2",{text:"\u81EA\u5B9A\u4E49\u5E95\u90E8\u4FA7\u8FB9\u680F\u6309\u94AE"})}createDescription(t){t.createDiv("basic-vault-button-description").setText("\u5728\u6B64\u6DFB\u52A0\u548C\u7BA1\u7406\u60A8\u7684\u5E95\u90E8\u4FA7\u8FB9\u680F\u6309\u94AE. \u60A8\u53EF\u4EE5\u5728\u4FA7\u8FB9\u680F\u4E2D\u76F4\u63A5\u62D6\u62FD\u81EA\u5B9A\u4E49\u6309\u94AE\u6765\u91CD\u65B0\u6392\u5E8F (\u5185\u7F6E\u6309\u94AE\u4E0D\u652F\u6301\u62D6\u62FD).")}createEmptyState(t){let e=t.createDiv("basic-vault-button-empty");e.createEl("p",{text:"\u8FD8\u6CA1\u6709\u6DFB\u52A0\u4EFB\u4F55\u81EA\u5B9A\u4E49\u6309\u94AE"}),e.createEl("p",{text:'\u70B9\u51FB\u4E0B\u65B9\u7684"\u6DFB\u52A0\u65B0\u6309\u94AE"\u5F00\u59CB\u521B\u5EFA',cls:"setting-item-description"})}createButtonsList(t){t.createDiv("basic-vault-button-section-title").setText("\u5DF2\u914D\u7F6E\u7684\u6309\u94AE"),this.plugin.settings.customButtons.forEach((s,n)=>{this.createButtonSetting(t,s,n)})}createAddButton(t){t.createEl("button",{text:"\u6DFB\u52A0\u65B0\u6309\u94AE",cls:"basic-vault-button-add-btn"}).addEventListener("click",()=>{this.addCustomButton()})}addCustomButton(){let t=v();this.plugin.settings.customButtons.unshift(t),this.plugin.saveSettings(),this.plugin.initVaultButtons(),this.display()}removeButton(t){this.plugin.settings.customButtons.splice(t,1),this.plugin.saveSettings(),this.plugin.initVaultButtons(),this.display()}createButtonSetting(t,e,s){let n=t.createDiv("basic-vault-button-setting-item");this.createSettingHeader(n,s),this.createSettingContent(n,e,s)}createSettingHeader(t,e){let s=t.createDiv("basic-vault-button-setting-header");s.createEl("span",{text:`\u6309\u94AE ${e+1}`,cls:"basic-vault-button-setting-title"}),s.createDiv("basic-vault-button-setting-actions").createEl("button",{text:"\u5220\u9664",cls:"basic-vault-button-action-btn basic-vault-button-delete-btn"}).addEventListener("click",()=>this.removeButton(e))}createSettingContent(t,e,s){let n=t.createDiv("basic-vault-button-setting-content");this.createTooltipSetting(n,e),this.createIconSetting(n,e),this.createTypeSetting(n,e,s),this.createTypeSpecificSetting(n,e,s)}createTooltipSetting(t,e){new r.Setting(t).setName("\u6309\u94AE\u540D\u79F0").setDesc("\u9F20\u6807\u60AC\u505C\u65F6\u663E\u793A\u7684\u63D0\u793A\u6587\u5B57").addText(s=>s.setValue(e.tooltip).setPlaceholder("\u4F8B\u5982\uFF1A\u6253\u5F00\u65E5\u8BB0").onChange(async n=>{e.tooltip=n,await this.plugin.saveSettings(),this.plugin.initVaultButtons()}))}createIconSetting(t,e){new r.Setting(t).setName("\u56FE\u6807").setDesc("\u8F93\u5165 Lucide \u56FE\u6807\u540D\u79F0").addText(s=>s.setValue(e.icon).setPlaceholder("lucide-home").onChange(async n=>{e.icon=n,await this.plugin.saveSettings(),this.plugin.initVaultButtons()}))}createTypeSetting(t,e,s){new r.Setting(t).setName("\u6309\u94AE\u7C7B\u578B").setDesc("\u9009\u62E9\u6309\u94AE\u70B9\u51FB\u65F6\u6267\u884C\u7684\u64CD\u4F5C").addDropdown(n=>n.addOption("command","\u6267\u884C\u547D\u4EE4").addOption("file","\u6253\u5F00\u6587\u4EF6").addOption("url","\u6253\u5F00\u7F51\u5740").setValue(e.type).onChange(async a=>{e.type=a,await this.plugin.saveSettings(),this.display()}))}createTypeSpecificSetting(t,e,s){switch(e.type){case"command":this.createCommandSetting(t,e);break;case"file":this.createFileSetting(t,e);break;case"url":this.createUrlSetting(t,e);break}}createCommandSetting(t,e){new r.Setting(t).setName("\u76EE\u6807\u547D\u4EE4").setDesc("\u9009\u62E9\u8981\u6267\u884C\u7684\u547D\u4EE4").addSearch(s=>{s.setValue(e.command),s.setPlaceholder("\u4F8B\u5982\uFF1Afile-explorer:new-file");let n=new p(this.app,a=>{e.command=a.id,s.setValue(a.id),this.plugin.saveSettings()});s.inputEl.addEventListener("click",()=>{n.open()}),s.onChange(a=>{e.command=a,this.plugin.saveSettings()})})}createFileSetting(t,e){new r.Setting(t).setName("\u76EE\u6807\u6587\u4EF6").setDesc("\u9009\u62E9\u8981\u6253\u5F00\u7684\u6587\u4EF6").addSearch(s=>{s.setValue(e.file),s.setPlaceholder("\u4F8B\u5982\uFF1A\u65E5\u8BB0/2024.md");let n=new u(this.app,a=>{e.file=a.path,s.setValue(a.path),this.plugin.saveSettings()});s.inputEl.addEventListener("click",()=>{n.open()}),s.onChange(a=>{e.file=a,this.plugin.saveSettings()})})}createUrlSetting(t,e){new r.Setting(t).setName("\u7F51\u5740\u94FE\u63A5").setDesc("\u8F93\u5165\u8981\u6253\u5F00\u7684\u5B8C\u6574\u7F51\u5740").addText(s=>s.setValue(e.url).setPlaceholder("https://example.com").onChange(async n=>{e.url=n,await this.plugin.saveSettings()}))}};var m=class extends b.Plugin{async onload(){await this.loadSettings(),this.buttonManager=new c(this.app,this.handleSettingsChange.bind(this),this.reorderButtons.bind(this)),this.buttonManager.applyStyleSettings(),this.initVaultButtons(),this.addSettingTab(new d(this.app,this))}onunload(){this.buttonManager&&this.buttonManager.destroy()}async loadSettings(){this.settings=Object.assign({},h,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}initVaultButtons(){this.buttonManager&&this.buttonManager.initVaultButtons(this.settings.customButtons)}handleSettingsChange(){this.saveSettings(),this.initVaultButtons()}reorderButtons(t,e){if(t===e)return;let[s]=this.settings.customButtons.splice(t,1);this.settings.customButtons.splice(e,0,s),this.saveSettings(),this.initVaultButtons()}};
